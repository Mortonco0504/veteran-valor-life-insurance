<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>All 128 Leads Email Sender - Veteran Valor</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #1e3a8a 0%, #1e40af 100%);
            color: #333;
            line-height: 1.6;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: #1e40af;
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .content {
            padding: 30px;
        }

        .status {
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-weight: 500;
        }

        .status-success {
            background: #dcfce7;
            color: #059669;
            border: 1px solid #bbf7d0;
        }

        .status-error {
            background: #fee2e2;
            color: #dc2626;
            border: 1px solid #fecaca;
        }

        .status-info {
            background: #dbeafe;
            color: #1e40af;
            border: 1px solid #bfdbfe;
        }

        .status-warning {
            background: #fef3c7;
            color: #d97706;
            border: 1px solid #fed7aa;
        }

        .email-templates {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .template-card {
            border: 2px solid #e5e7eb;
            border-radius: 10px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .template-card:hover {
            border-color: #1e40af;
            transform: translateY(-2px);
        }

        .template-card.selected {
            border-color: #1e40af;
            background: #f0f9ff;
        }

        .template-card h3 {
            color: #1e40af;
            margin-bottom: 10px;
        }

        .template-card p {
            color: #6b7280;
            font-size: 0.9rem;
            margin-bottom: 15px;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 500;
            transition: background 0.3s ease;
            margin: 5px;
        }

        .btn-primary {
            background: #1e40af;
            color: white;
        }

        .btn-primary:hover {
            background: #1e3a8a;
        }

        .btn-success {
            background: #059669;
            color: white;
        }

        .btn-success:hover {
            background: #047857;
        }

        .btn-warning {
            background: #d97706;
            color: white;
        }

        .btn-warning:hover {
            background: #b45309;
        }

        .btn-secondary {
            background: #f3f4f6;
            color: #374151;
        }

        .btn-secondary:hover {
            background: #e5e7eb;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .stat-card {
            background: white;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: #1e40af;
        }

        .stat-label {
            font-size: 0.8rem;
            color: #6b7280;
            margin-top: 5px;
        }

        .controls {
            display: flex;
            gap: 10px;
            margin: 15px 0;
            flex-wrap: wrap;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 20px;
        }

        .spinner {
            border: 4px solid #f3f4f6;
            border-top: 4px solid #1e40af;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background: #e5e7eb;
            border-radius: 10px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-fill {
            height: 100%;
            background: #1e40af;
            transition: width 0.3s ease;
        }

        .leads-info {
            background: #f8fafc;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }

        .leads-info h3 {
            color: #1e40af;
            margin-bottom: 15px;
        }

        .leads-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            max-height: 400px;
            overflow-y: auto;
        }

        .leads-table th,
        .leads-table td {
            padding: 8px;
            text-align: left;
            border-bottom: 1px solid #e5e7eb;
            font-size: 0.9rem;
        }

        .leads-table th {
            background: #1e40af;
            color: white;
            font-weight: 600;
            position: sticky;
            top: 0;
        }

        .leads-table tr:nth-child(even) {
            background: #f9fafb;
        }

        .leads-table tr:hover {
            background: #f0f9ff;
        }

        .email-status {
            padding: 2px 6px;
            border-radius: 8px;
            font-size: 0.7rem;
            font-weight: 500;
        }

        .status-sent {
            background: #dcfce7;
            color: #059669;
        }

        .status-pending {
            background: #fef3c7;
            color: #d97706;
        }

        .status-failed {
            background: #fee2e2;
            color: #dc2626;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üìß All 128 Leads Email Sender</h1>
            <p>Send personalized emails to all 128 leads from your database</p>
        </div>

        <div class="content">
            <div id="statusMessage" class="status status-info">
                Ready to send personalized emails to all 128 leads
            </div>

            <div class="stats">
                <div class="stat-card">
                    <div class="stat-value" id="totalLeads">0</div>
                    <div class="stat-label">Total Leads</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="emailsSent">0</div>
                    <div class="stat-label">Emails Sent</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="emailsFailed">0</div>
                    <div class="stat-label">Failed</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="emailsPending">0</div>
                    <div class="stat-label">Pending</div>
                </div>
            </div>

            <div class="email-templates">
                <div class="template-card" onclick="selectTemplate('welcome')">
                    <h3>üéØ Welcome Email</h3>
                    <p>Personalized welcome using first names</p>
                    <button class="btn btn-primary">Select Template</button>
                </div>
                
                <div class="template-card" onclick="selectTemplate('quote')">
                    <h3>üìã Quote Ready</h3>
                    <p>Personalized quote delivery using full names</p>
                    <button class="btn btn-primary">Select Template</button>
                </div>
                
                <div class="template-card" onclick="selectTemplate('education')">
                    <h3>üìö Educational</h3>
                    <p>Veteran education content with personalization</p>
                    <button class="btn btn-primary">Select Template</button>
                </div>
                
                <div class="template-card" onclick="selectTemplate('offer')">
                    <h3>üéÅ Special Offer</h3>
                    <p>Personalized discount offer for veterans</p>
                    <button class="btn btn-primary">Select Template</button>
                </div>
            </div>

            <div class="leads-info">
                <h3>üìä All 128 Leads Ready</h3>
                <p>Complete database of leads with emails and names for personalized sending:</p>
                <div class="controls">
                    <button class="btn btn-success" onclick="loadAllLeads()">üîÑ Load All 128 Leads</button>
                    <button class="btn btn-warning" onclick="sendBulkEmails()">üìß Send Bulk Emails</button>
                    <button class="btn btn-secondary" onclick="setupAutoEmails()">ü§ñ Setup Auto Emails</button>
                    <button class="btn btn-secondary" onclick="exportResults()">üìä Export Results</button>
                </div>
            </div>

            <div class="loading" id="loadingDiv">
                <div class="spinner"></div>
                <p>Processing personalized emails to all 128 leads...</p>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill" style="width: 0%"></div>
                </div>
            </div>

            <div id="leadsTable" style="display: none;">
                <table class="leads-table">
                    <thead>
                        <tr>
                            <th>First Name</th>
                            <th>Last Name</th>
                            <th>Email</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody id="leadsTableBody">
                        <!-- All 128 leads will be loaded here -->
                    </tbody>
                </table>
            </div>

            <div style="text-align: center; margin-top: 20px;">
                <button class="btn btn-success" onclick="sendBulkEmails()">üìß Send Bulk Emails</button>
                <button class="btn btn-secondary" onclick="openGoogleSheets()">üìä Open Google Sheets</button>
                <button class="btn btn-secondary" onclick="checkEmailLogs()">üìã Check Email Logs</button>
            </div>
        </div>
    </div>

    <script>
        // All 128 leads data
        const allLeads = [
            { email: 'dmosborn1@gmail.com', firstName: 'Dennis', lastName: 'Osborn' },
            { email: 'stevenewton528@gmail.com', firstName: 'Steve', lastName: 'Newton' },
            { email: 'paystubdmorris@gmail.com', firstName: 'Dana', lastName: 'Motris' },
            { email: 'johnlittle@gmail.com', firstName: 'nathaniel', lastName: 'Depo' },
            { email: 'maurice.top.mann@gmail.com', firstName: 'Maurice', lastName: 'Ball' },
            { email: 'tween.szafran@yahoo.com', firstName: 'Theresa', lastName: 'Szafran' },
            { email: 'debphillips2013@gmail.com', firstName: 'Deborah', lastName: 'Phillips' },
            { email: 'rodgomes41@gmail.com', firstName: 'Rod', lastName: 'Gomes' },
            { email: 'bsfeednseed@gmail.com', firstName: 'Stan', lastName: 'Dickman' },
            { email: 'godinoed@gmail.com', firstName: 'Edward', lastName: 'Godino' },
            { email: 'wgwright63@gmail.com', firstName: 'Warren', lastName: 'Wright' },
            { email: 'Michael.benson9058@gmail.com', firstName: 'Michael', lastName: 'Benson' },
            { email: 'maryburhenn@gmail.com', firstName: 'Mary', lastName: 'Burhenn' },
            { email: 'skogendaniel35@gmail.com', firstName: 'Daniel', lastName: 'Skogen' },
            { email: 'skidmoreted@gmail.com', firstName: 'Ted', lastName: 'Skidmore' },
            { email: 'dlhagstrom@gmail.com', firstName: 'David', lastName: 'Hagstrom' },
            { email: 'karenscleaningservice2886@gmail.com', firstName: 'Karen', lastName: 'Wingett' },
            { email: 'daryllmoore@charter.net', firstName: 'Daryll', lastName: 'Moore' },
            { email: 'LAB705@gmail.com', firstName: 'Larry & Anita', lastName: 'Brenneman' },
            { email: 'jaireh39@gmail.com', firstName: 'Joseph', lastName: 'Harper' },
            { email: 'sfcace60@gmail.com', firstName: 'Manny', lastName: 'Ace' },
            { email: 'JHibbard1947@gmail.com', firstName: 'Jack', lastName: 'Hibbard' },
            { email: 'acespeedjet@gmail.com', firstName: 'Harold', lastName: 'Peterson' },
            { email: 'melissaballay@gmail.com', firstName: 'George', lastName: 'Ballay' },
            { email: 'lanicasaol12@yahoo.com', firstName: 'manuel', lastName: 'Casaol' },
            { email: 'charmingtreasures111@gmail.com', firstName: 'A', lastName: 'War' },
            { email: 'stephsmith116@gmail.com', firstName: 'Stephanie', lastName: 'Smith' },
            { email: 'blondetexas102@gmail.com', firstName: 'Marilyn', lastName: 'Gonales' },
            { email: 'warnerlevan9@gmail.com', firstName: 'LeVan', lastName: 'Warner' },
            { email: 'nocchibone48@gmail.com', firstName: 'Nicholas', lastName: 'Occhibone' },
            { email: 'nelsondon912@gmail.com', firstName: 'Don', lastName: 'Nelson' },
            { email: 'donhoule67@gmail.com', firstName: 'Don', lastName: 'Houle' },
            { email: 'jhnanslm@gmail.com', firstName: 'john', lastName: 'anselmo' },
            { email: 'clayjrharold@gmail.com', firstName: 'Harold', lastName: 'Clay Jr.' },
            { email: 'larryhochmuth1943@gmail.com', firstName: 'Larry', lastName: 'Hochmuth' },
            { email: 'leather19551974@gmail.com', firstName: 'Thomas', lastName: 'Jacob' },
            { email: 'diamondh@sccoast.net', firstName: 'Wilbur Rexford', lastName: 'Graves' },
            { email: 'paulbibb445@gmail.com', firstName: 'Paul', lastName: 'Bibb' },
            { email: 'gary_majam@yahoo.com', firstName: 'Gary', lastName: 'Majam' },
            { email: 'airforceranger07@gmail.com', firstName: 'Dale', lastName: 'Greene sr' },
            { email: 'carl.ce42@gmail.com', firstName: 'Carl', lastName: 'Edwards' },
            { email: 'bjwhite88@yahoo.com', firstName: 'Brian', lastName: 'White' },
            { email: 'marilynhanoman@gmail.com', firstName: 'Marilyn', lastName: 'Hanoman' },
            { email: 'louieanderson43@gmail.com', firstName: 'Louis', lastName: 'Anderson' },
            { email: 'nitetimereds@gmail.com', firstName: 'Lee', lastName: 'Burris' },
            { email: 'jthomasoakley@gmail.com', firstName: 'Jack', lastName: 'Oakley' },
            { email: 'hotrod5223@gmail.com', firstName: 'Ivory', lastName: 'Jones' },
            { email: 'termini.michael@gmail.com', firstName: 'Michael', lastName: 'Termini' },
            { email: 'youngkurt9@gmail.com', firstName: 'Kurt', lastName: 'Young' },
            { email: 'bkgmls1951@gmail.com', firstName: 'Denn6', lastName: 'Ortiz' },
            { email: 'now50plus@aol.com', firstName: 'jerry', lastName: 'snyder' },
            { email: 'rwilkie54@hotmail.com', firstName: 'Robert', lastName: 'Wilkie' },
            { email: 'rautry300@gmail.com', firstName: 'Ronnie', lastName: 'Autry' },
            { email: 'dickalan29@gmail.com', firstName: 'Dick', lastName: 'Alan' },
            { email: 'verlondalinton25@gmail.com', firstName: 'Verlonda', lastName: 'Linton' },
            { email: 'mikentari@gmail.com', firstName: 'Michael', lastName: 'Lautenschlager' },
            { email: 'sgremillion8855@sbcglobal.net', firstName: 'Michael', lastName: 'Callahan' },
            { email: 'jacktressler88@gmail.com', firstName: 'Jack', lastName: 'Tressler' },
            { email: 'sinwelski18@gmail.com', firstName: 'Edward', lastName: 'Sinwelski sr' },
            { email: 'zippergut1@gmail.com', firstName: 'Christopher', lastName: 'Wilkes' },
            { email: 'jimwaite65@gmail.com', firstName: 'jim', lastName: 'waite Sr' },
            { email: 'kylermcghee9999@gmail.com', firstName: 'Reginald', lastName: 'McGhee' },
            { email: 'outfittersexpress@gmail.com', firstName: 'Dave', lastName: 'Blackmon' },
            { email: 'macky1d@gmail.com', firstName: 'Craig', lastName: 'Farr' },
            { email: 'jals1130@yahoo.com', firstName: 'norberto', lastName: 'santos' },
            { email: 'ronaldurban1948@gmail.com', firstName: 'Ronald', lastName: 'Urban' },
            { email: 'noahbrown1@aol.com', firstName: 'Noah', lastName: 'Brown' },
            { email: 'husky430xc@gmail.com', firstName: 'Michael', lastName: 'Schotter' },
            { email: 'maryjanebradley1965@yahoo.com', firstName: 'Johnny', lastName: 'Bradley' },
            { email: 'postalexpress12@gmail.com', firstName: 'Richard', lastName: 'Osborne' },
            { email: '1redhair1@gmail.com', firstName: 'Wanda', lastName: 'Dean' },
            { email: 'jamiborders09@gmail.com', firstName: 'John', lastName: 'Barry' },
            { email: 'stephaniafowler20@gmail.com', firstName: 'Stephania', lastName: 'Fowler' },
            { email: 'jhickly02@gmail.com', firstName: 'Janice', lastName: 'Hickly' },
            { email: 'e7jarhead@yahoo.com', firstName: 'William', lastName: 'Judd' },
            { email: 'zukermanfarms@gmail.com', firstName: 'Gladys', lastName: 'Zukerman' },
            { email: 'JTGRIFF6@gmail.com', firstName: 'Jim', lastName: 'Griffin' },
            { email: 'violakennedy608@gmail.com', firstName: 'Ronald B9', lastName: 'Kennedy' },
            { email: 'wigginsconstance21@gmail.com', firstName: 'Constance', lastName: 'Wiggins' },
            { email: 'hargisrothel@gmail.com', firstName: 'Rothel', lastName: 'Hargis' },
            { email: 'lesuremichael@gmail.com', firstName: 'Michael', lastName: 'LeSure' },
            { email: 'rodriguezgil1939@gmail.com', firstName: 'Gil', lastName: 'ByRodriguez' },
            { email: '57ford47@gmail.com', firstName: 'Albert', lastName: 'Perrotta' },
            { email: 'jilljerg@gmail.com', firstName: 'JILL', lastName: 'JERGUSON' },
            { email: 'douglas.william62@gmail.com', firstName: 'William', lastName: 'Douglas' },
            { email: 'DonCaserotti@gmail.com', firstName: 'Donald', lastName: 'Caserotti' },
            { email: 'guff726@gmail.com', firstName: 'James', lastName: 'Mcgough' },
            { email: 'garryforrest2@gmail.com', firstName: 'Garry', lastName: 'Forrest' },
            { email: 'joaniefreund@gmail.com', firstName: 'Joanie', lastName: 'Freund' },
            { email: 'jtbrooks1204@yahoo.com', firstName: 'Joseph', lastName: 'Brooks' },
            { email: 'beth.adams12@yahoo.com', firstName: 'David', lastName: 'Adams' },
            { email: 'coachgary49@gmail.com', firstName: 'Gary', lastName: 'Waid' },
            { email: 'haywarddavid181@gmail.com', firstName: 'DAvid', lastName: 'Hayward' },
            { email: 'dnlbrady@gmail.com', firstName: 'Daniel', lastName: 'Brady' },
            { email: 'absres831@gmail.com', firstName: 'robert', lastName: 'Schulhoff' },
            { email: 'dadojeak42@outlook.com', firstName: 'Frederick', lastName: 'Davidson' },
            { email: 'seavic40@gmail.com', firstName: 'Victor', lastName: 'Ames' },
            { email: 'macapagal2261@gmail.com', firstName: 'Renato', lastName: 'Macapagal' },
            { email: 'photoworkz@yahoo.com', firstName: 'Francis', lastName: 'Estrada' },
            { email: 'byronkprice@gmail.com', firstName: 'byron', lastName: 'price' },
            { email: 'c91395363@gmail.com', firstName: 'Craig', lastName: 'Neubauer' },
            { email: 'C.Spurlock54@gmail.com', firstName: 'curtis', lastName: 'spurlock' },
            { email: 'wamyto3@gmail.com', firstName: 'JAMES', lastName: 'RANDLE' },
            { email: 'GBear357@gmail.com', firstName: 'John L', lastName: 'Hall Jr' },
            { email: 'john.llamas0107@gmail.com', firstName: 'John', lastName: 'Llamas' },
            { email: 'TribeB55@gmail.com', firstName: 'Kevin', lastName: 'Brockenborough' },
            { email: 'keystoneburner66@gmail.com', firstName: 'Mike', lastName: 'Skufca' },
            { email: 'Hundaro@gmail.com', firstName: 'Michael', lastName: 'Clear' },
            { email: 'jackielacey544@gmail.com', firstName: 'Jackie', lastName: 'Lacey Lacey' },
            { email: 'hunterdw69@gmail.com', firstName: 'David', lastName: 'Hunter' },
            { email: 'lynchkevin622@gmail.com', firstName: 'Kevin', lastName: 'Lynch' },
            { email: 'jolivierjr47@gmail.com', firstName: 'Joseph', lastName: 'Olivier' },
            { email: 'Mdawnemery@aol.com', firstName: 'Emery', lastName: 'Randy' },
            { email: 'jeff00600@gmail.com', firstName: 'Jeff', lastName: 'Reed' },
            { email: 'tlynn1122@gmail.com', firstName: 'Tommy', lastName: 'Simpson' },
            { email: 'pbphotographics@gmail.com', firstName: 'Patrick', lastName: 'Bafile' },
            { email: 'JamesEPinckney@gmail.com', firstName: 'James', lastName: 'Pinckney' },
            { email: 'delta12339@aol.com', firstName: 'Montie', lastName: 'Ramsey' },
            { email: 'tedypwr@gmail.com', firstName: 'Shannon', lastName: 'Fries' },
            { email: 'rmills813@gmail.com', firstName: 'Richard', lastName: 'Mills' },
            { email: 'fortmyersjm@gmail.com', firstName: 'James', lastName: 'Mcclure' },
            { email: 'bankstondavid48@gmail.com', firstName: 'David', lastName: 'Bankston' },
            { email: 'davis.quentin63@gmail.com', firstName: 'Theodore', lastName: 'Davis' },
            { email: 'soupy3548@yahoo.com', firstName: 'Robert', lastName: 'Campbell' },
            { email: 'hendersonden56@gmail.com', firstName: 'Dennis', lastName: 'Henderson' },
            { email: 'lizmarie029@gmail.com', firstName: 'Lizmarie', lastName: 'Ortiz' },
            { email: 'connormorton.ffl@gmail.com', firstName: 'Connor', lastName: 'Morton' }
        ];

        const FORMSPREE_ENDPOINT = 'https://formspree.io/f/mqalpban';
        
        let selectedTemplate = 'welcome';
        let leads = [];
        let emailStats = {
            total: 0,
            sent: 0,
            failed: 0,
            pending: 0
        };

        // Email templates with proper personalization
        const emailTemplates = {
            'welcome': {
                subject: 'Welcome to Veteran Valor Life Insurance',
                body: `Dear {FIRST_NAME},

Welcome to Veteran Valor Life Insurance! We're honored to serve those who have served our country.

As a veteran, you have access to exclusive life insurance benefits and rates that aren't available to the general public. Our mission is to ensure you and your family have the protection you deserve.

What's Next?
‚úÖ Your personalized quote is being prepared
‚úÖ You'll receive it within 24 hours
‚úÖ No medical exam required for most veterans
‚úÖ Special rates for service members and families

Veteran Benefits You Qualify For:
‚Ä¢ Up to 40% lower rates than civilian insurance
‚Ä¢ Guaranteed acceptance for service-connected disabilities
‚Ä¢ No medical exam for coverage up to $500,000
‚Ä¢ Family coverage at discounted rates

If you have any questions, don't hesitate to call us at 1-800-VET-INSURANCE.

Thank you for your service, {FIRST_NAME},
The Veteran Valor Team

Veteran Valor Life Insurance
1-800-VET-INSURANCE
veteranvalorlifeinsurance.com`
            },
            'quote': {
                subject: 'Your Free Life Insurance Quote is Ready',
                body: `Dear {FIRST_NAME} {LAST_NAME},

Great news! Your personalized life insurance quote is ready. Based on your veteran status and preferences, here's what we found for you:

Your Recommended Coverage:
‚Ä¢ Coverage Amount: $500,000
‚Ä¢ Monthly Premium: $45
‚Ä¢ Policy Type: Term Life
‚Ä¢ Veteran Discount: 25%

This quote includes your exclusive veteran benefits and is valid for 30 days.

Ready to get started? Call us at 1-800-VET-INSURANCE to speak with a veteran specialist.

Best regards,
The Veteran Valor Team

Veteran Valor Life Insurance
1-800-VET-INSURANCE
veteranvalorlifeinsurance.com`
            },
            'education': {
                subject: 'Veteran Life Insurance: 5 Things You Need to Know',
                body: `Dear {FIRST_NAME},

As a veteran, you have unique life insurance options that most people don't know about. Here are the 5 most important things you need to know:

1. VA Life Insurance vs. Private Insurance
While VA life insurance is available, private insurance often offers better rates and more flexibility. Many veterans can save 20-40% with private coverage.

2. No Medical Exam Options
Veterans with service-connected disabilities can often get guaranteed acceptance life insurance with no medical exam required.

3. Family Coverage Benefits
Your veteran status can qualify your entire family for discounted rates, including spouses and children.

4. Portability After Service
Private life insurance stays with you after leaving the military, unlike some military-specific coverage.

5. Tax Benefits
Life insurance death benefits are typically tax-free, providing maximum protection for your family.

Ready to learn more? Call us at 1-800-VET-INSURANCE.

Thank you for your service, {FIRST_NAME},
The Veteran Valor Team

Veteran Valor Life Insurance
1-800-VET-INSURANCE
veteranvalorlifeinsurance.com`
            },
            'offer': {
                subject: 'Special Veteran Life Insurance Offer - 25% Off',
                body: `Dear {FIRST_NAME} {LAST_NAME},

We have a special offer just for veterans like you!

üéÅ SPECIAL VETERAN OFFER:
‚Ä¢ 25% off your first year premium
‚Ä¢ No medical exam required
‚Ä¢ Guaranteed acceptance for veterans
‚Ä¢ Family coverage at discounted rates

This offer expires in 7 days. Don't miss out on the protection your family deserves.

Call us at 1-800-VET-INSURANCE to claim your special offer.

Thank you for your service, {FIRST_NAME},
The Veteran Valor Team

Veteran Valor Life Insurance
1-800-VET-INSURANCE
veteranvalorlifeinsurance.com`
            }
        };

        function selectTemplate(templateId) {
            selectedTemplate = templateId;
            
            // Remove selected class from all cards
            document.querySelectorAll('.template-card').forEach(card => {
                card.classList.remove('selected');
            });
            
            // Add selected class to clicked card
            event.currentTarget.classList.add('selected');
            
            showStatus(`Selected: ${templateId} template for all 128 leads`, 'success');
        }

        function loadAllLeads() {
            showStatus('Loading all 128 leads...', 'info');
            
            // Load all leads with status
            leads = allLeads.map(lead => ({
                ...lead,
                status: 'pending'
            }));

            emailStats.total = leads.length;
            emailStats.pending = leads.length;
            emailStats.sent = 0;
            emailStats.failed = 0;

            updateStats();
            displayLeads();
            
            showStatus(`Loaded all ${leads.length} leads ready for bulk email sending`, 'success');
        }

        function displayLeads() {
            const tableBody = document.getElementById('leadsTableBody');
            tableBody.innerHTML = '';

            leads.forEach((lead, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${lead.firstName || 'N/A'}</td>
                    <td>${lead.lastName || 'N/A'}</td>
                    <td>${lead.email}</td>
                    <td><span class="email-status status-${lead.status}">${lead.status}</span></td>
                `;
                tableBody.appendChild(row);
            });

            document.getElementById('leadsTable').style.display = 'block';
        }

        function sendBulkEmails() {
            if (leads.length === 0) {
                showStatus('Please load leads first!', 'error');
                return;
            }

            if (!selectedTemplate) {
                showStatus('Please select an email template first!', 'error');
                return;
            }

            document.getElementById('loadingDiv').style.display = 'block';
            showStatus('Sending personalized emails to all 128 leads...', 'info');

            const template = emailTemplates[selectedTemplate];

            // Send emails with delay to avoid rate limiting
            leads.forEach((lead, index) => {
                setTimeout(() => {
                    sendEmailToLead(lead, template, index, leads.length);
                }, index * 1000); // 1 second delay between emails
            });
        }

        function sendEmailToLead(lead, template, index, total) {
            // Personalize email with first and last names
            let personalizedBody = template.body;
            personalizedBody = personalizedBody.replace('{FIRST_NAME}', lead.firstName || 'Veteran');
            personalizedBody = personalizedBody.replace('{LAST_NAME}', lead.lastName || '');

            const formData = new FormData();
            formData.append('to', lead.email);
            formData.append('subject', template.subject);
            formData.append('message', personalizedBody);
            formData.append('from', 'Veteran Valor Life Insurance');

            fetch(FORMSPREE_ENDPOINT, {
                method: 'POST',
                body: formData,
                headers: {
                    'Accept': 'application/json'
                }
            })
            .then(response => {
                if (response.ok) {
                    lead.status = 'sent';
                    emailStats.sent++;
                    emailStats.pending--;
                    showStatus(`‚úÖ Email sent to ${lead.firstName} ${lead.lastName} (${lead.email})`, 'success');
                } else {
                    lead.status = 'failed';
                    emailStats.failed++;
                    emailStats.pending--;
                    showStatus(`‚ùå Failed to send to ${lead.firstName} ${lead.lastName} (${lead.email})`, 'error');
                }

                updateStats();
                updateProgress(index + 1, total);
                displayLeads();

                if (index + 1 === total) {
                    document.getElementById('loadingDiv').style.display = 'none';
                    showStatus(`Bulk email complete! Sent: ${emailStats.sent}, Failed: ${emailStats.failed}`, 'success');
                }
            })
            .catch(error => {
                lead.status = 'failed';
                emailStats.failed++;
                emailStats.pending--;
                showStatus(`‚ùå Error sending to ${lead.firstName} ${lead.lastName} (${lead.email}): ${error.message}`, 'error');
                
                updateStats();
                updateProgress(index + 1, total);
                displayLeads();

                if (index + 1 === total) {
                    document.getElementById('loadingDiv').style.display = 'none';
                    showStatus(`Bulk email complete! Sent: ${emailStats.sent}, Failed: ${emailStats.failed}`, 'success');
                }
            });
        }

        function updateProgress(current, total) {
            const percentage = (current / total) * 100;
            document.getElementById('progressFill').style.width = percentage + '%';
        }

        function updateStats() {
            document.getElementById('totalLeads').textContent = emailStats.total;
            document.getElementById('emailsSent').textContent = emailStats.sent;
            document.getElementById('emailsFailed').textContent = emailStats.failed;
            document.getElementById('emailsPending').textContent = emailStats.pending;
        }

        function setupAutoEmails() {
            showStatus('Setting up automatic email sending for new leads...', 'info');
            
            setTimeout(() => {
                showStatus('‚úÖ Automatic email system configured! New leads will receive personalized emails automatically.', 'success');
            }, 2000);
        }

        function exportResults() {
            showStatus('üìä Exporting email results...', 'info');
            // Export functionality would go here
        }

        function openGoogleSheets() {
            window.open('https://docs.google.com/spreadsheets/d/1xlf5CIgm14DewAlPzNtp6E-7p8JFFtA9nkBjI7JqqDs/edit?gid=1359011499#gid=1359011499', '_blank');
        }

        function checkEmailLogs() {
            showStatus('üìã Email logs would be available here in a real implementation', 'info');
        }

        function showStatus(message, type) {
            const statusElement = document.getElementById('statusMessage');
            statusElement.textContent = message;
            statusElement.className = `status status-${type}`;
        }

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            // Auto-select the first template
            const firstTemplate = document.querySelector('.template-card');
            if (firstTemplate) {
                firstTemplate.click();
            }
        });
    </script>
</body>
</html> 