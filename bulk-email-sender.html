<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bulk Email Sender - Veteran Valor</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #1e3a8a 0%, #1e40af 100%);
            color: #333;
            line-height: 1.6;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: #1e40af;
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .content {
            padding: 30px;
        }

        .status {
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-weight: 500;
        }

        .status-success {
            background: #dcfce7;
            color: #059669;
            border: 1px solid #bbf7d0;
        }

        .status-error {
            background: #fee2e2;
            color: #dc2626;
            border: 1px solid #fecaca;
        }

        .status-info {
            background: #dbeafe;
            color: #1e40af;
            border: 1px solid #bfdbfe;
        }

        .status-warning {
            background: #fef3c7;
            color: #d97706;
            border: 1px solid #fed7aa;
        }

        .email-templates {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .template-card {
            border: 2px solid #e5e7eb;
            border-radius: 10px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .template-card:hover {
            border-color: #1e40af;
            transform: translateY(-2px);
        }

        .template-card.selected {
            border-color: #1e40af;
            background: #f0f9ff;
        }

        .template-card h3 {
            color: #1e40af;
            margin-bottom: 10px;
        }

        .template-card p {
            color: #6b7280;
            font-size: 0.9rem;
            margin-bottom: 15px;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 500;
            transition: background 0.3s ease;
            margin: 5px;
        }

        .btn-primary {
            background: #1e40af;
            color: white;
        }

        .btn-primary:hover {
            background: #1e3a8a;
        }

        .btn-success {
            background: #059669;
            color: white;
        }

        .btn-success:hover {
            background: #047857;
        }

        .btn-warning {
            background: #d97706;
            color: white;
        }

        .btn-warning:hover {
            background: #b45309;
        }

        .btn-secondary {
            background: #f3f4f6;
            color: #374151;
        }

        .btn-secondary:hover {
            background: #e5e7eb;
        }

        .leads-section {
            background: #f8fafc;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }

        .leads-section h3 {
            color: #1e40af;
            margin-bottom: 15px;
        }

        .leads-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .leads-table th,
        .leads-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e5e7eb;
        }

        .leads-table th {
            background: #1e40af;
            color: white;
            font-weight: 600;
        }

        .leads-table tr:nth-child(even) {
            background: #f9fafb;
        }

        .leads-table tr:hover {
            background: #f0f9ff;
        }

        .email-status {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 500;
        }

        .status-sent {
            background: #dcfce7;
            color: #059669;
        }

        .status-pending {
            background: #fef3c7;
            color: #d97706;
        }

        .status-failed {
            background: #fee2e2;
            color: #dc2626;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 20px;
        }

        .spinner {
            border: 4px solid #f3f4f6;
            border-top: 4px solid #1e40af;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background: #e5e7eb;
            border-radius: 10px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-fill {
            height: 100%;
            background: #1e40af;
            transition: width 0.3s ease;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .stat-card {
            background: white;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: #1e40af;
        }

        .stat-label {
            font-size: 0.8rem;
            color: #6b7280;
            margin-top: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üìß Bulk Email Sender</h1>
            <p>Send emails to all leads from your Google Sheets</p>
        </div>

        <div class="content">
            <div id="statusMessage" class="status status-info">
                Ready to send emails to all leads from your Google Sheets
            </div>

            <div class="stats">
                <div class="stat-card">
                    <div class="stat-value" id="totalLeads">0</div>
                    <div class="stat-label">Total Leads</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="emailsSent">0</div>
                    <div class="stat-label">Emails Sent</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="emailsFailed">0</div>
                    <div class="stat-label">Failed</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="emailsPending">0</div>
                    <div class="stat-label">Pending</div>
                </div>
            </div>

            <div class="email-templates">
                <div class="template-card" onclick="selectTemplate('welcome')">
                    <h3>üéØ Welcome Email</h3>
                    <p>Initial welcome message for new leads</p>
                    <button class="btn btn-primary">Select Template</button>
                </div>
                
                <div class="template-card" onclick="selectTemplate('quote')">
                    <h3>üìã Quote Ready</h3>
                    <p>Personalized quote delivery email</p>
                    <button class="btn btn-primary">Select Template</button>
                </div>
                
                <div class="template-card" onclick="selectTemplate('education')">
                    <h3>üìö Educational</h3>
                    <p>Veteran life insurance education content</p>
                    <button class="btn btn-primary">Select Template</button>
                </div>
                
                <div class="template-card" onclick="selectTemplate('offer')">
                    <h3>üéÅ Special Offer</h3>
                    <p>Limited-time veteran discount offer</p>
                    <button class="btn btn-primary">Select Template</button>
                </div>
            </div>

            <div class="leads-section">
                <h3>üìä Leads from Google Sheets</h3>
                <p>Emails from column F in your spreadsheet:</p>
                <button class="btn btn-success" onclick="loadLeadsFromSheet()">üîÑ Load Leads from Sheet</button>
                <button class="btn btn-warning" onclick="sendBulkEmails()">üìß Send Bulk Emails</button>
                <button class="btn btn-secondary" onclick="setupAutoEmails()">ü§ñ Setup Auto Emails</button>
            </div>

            <div class="loading" id="loadingDiv">
                <div class="spinner"></div>
                <p>Processing emails...</p>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill" style="width: 0%"></div>
                </div>
            </div>

            <div id="leadsTable" style="display: none;">
                <table class="leads-table">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Email</th>
                            <th>Phone</th>
                            <th>Region</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody id="leadsTableBody">
                        <!-- Leads will be loaded here -->
                    </tbody>
                </table>
            </div>

            <div style="text-align: center; margin-top: 20px;">
                <button class="btn btn-success" onclick="sendBulkEmails()">üìß Send Bulk Emails</button>
                <button class="btn btn-secondary" onclick="openGoogleSheets()">üìä Open Google Sheets</button>
                <button class="btn btn-secondary" onclick="checkEmailLogs()">üìã Check Email Logs</button>
            </div>
        </div>
    </div>

    <script>
        // Google Sheets data
        const SHEET_URL = 'https://docs.google.com/spreadsheets/d/1xlf5CIgm14DewAlPzNtp6E-7p8JFFtA9nkBjI7JqqDs/edit?gid=1359011499#gid=1359011499';
        const FORMSPREE_ENDPOINT = 'https://formspree.io/f/mqalpban';
        
        let selectedTemplate = 'welcome';
        let leads = [];
        let emailStats = {
            total: 0,
            sent: 0,
            failed: 0,
            pending: 0
        };

        // Email templates
        const emailTemplates = {
            'welcome': {
                subject: 'Welcome to Veteran Valor Life Insurance',
                body: `Dear {FIRST_NAME},

Welcome to Veteran Valor Life Insurance! We're honored to serve those who have served our country.

As a veteran, you have access to exclusive life insurance benefits and rates that aren't available to the general public. Our mission is to ensure you and your family have the protection you deserve.

What's Next?
‚úÖ Your personalized quote is being prepared
‚úÖ You'll receive it within 24 hours
‚úÖ No medical exam required for most veterans
‚úÖ Special rates for service members and families

Veteran Benefits You Qualify For:
‚Ä¢ Up to 40% lower rates than civilian insurance
‚Ä¢ Guaranteed acceptance for service-connected disabilities
‚Ä¢ No medical exam for coverage up to $500,000
‚Ä¢ Family coverage at discounted rates

If you have any questions, don't hesitate to call us at 1-800-VET-INSURANCE.

Thank you for your service,
The Veteran Valor Team

Veteran Valor Life Insurance
1-800-VET-INSURANCE
veteranvalorlifeinsurance.com`
            },
            'quote': {
                subject: 'Your Free Life Insurance Quote is Ready',
                body: `Dear {FIRST_NAME},

Great news! Your personalized life insurance quote is ready. Based on your veteran status and preferences, here's what we found for you:

Your Recommended Coverage:
‚Ä¢ Coverage Amount: $500,000
‚Ä¢ Monthly Premium: $45
‚Ä¢ Policy Type: Term Life
‚Ä¢ Veteran Discount: 25%

This quote includes your exclusive veteran benefits and is valid for 30 days.

Ready to get started? Call us at 1-800-VET-INSURANCE to speak with a veteran specialist.

Best regards,
The Veteran Valor Team

Veteran Valor Life Insurance
1-800-VET-INSURANCE
veteranvalorlifeinsurance.com`
            },
            'education': {
                subject: 'Veteran Life Insurance: 5 Things You Need to Know',
                body: `Dear {FIRST_NAME},

As a veteran, you have unique life insurance options that most people don't know about. Here are the 5 most important things you need to know:

1. VA Life Insurance vs. Private Insurance
While VA life insurance is available, private insurance often offers better rates and more flexibility. Many veterans can save 20-40% with private coverage.

2. No Medical Exam Options
Veterans with service-connected disabilities can often get guaranteed acceptance life insurance with no medical exam required.

3. Family Coverage Benefits
Your veteran status can qualify your entire family for discounted rates, including spouses and children.

4. Portability After Service
Private life insurance stays with you after leaving the military, unlike some military-specific coverage.

5. Tax Benefits
Life insurance death benefits are typically tax-free, providing maximum protection for your family.

Ready to learn more? Call us at 1-800-VET-INSURANCE.

Thank you for your service,
The Veteran Valor Team

Veteran Valor Life Insurance
1-800-VET-INSURANCE
veteranvalorlifeinsurance.com`
            },
            'offer': {
                subject: 'Special Veteran Life Insurance Offer - 25% Off',
                body: `Dear {FIRST_NAME},

We have a special offer just for veterans like you!

üéÅ SPECIAL VETERAN OFFER:
‚Ä¢ 25% off your first year premium
‚Ä¢ No medical exam required
‚Ä¢ Guaranteed acceptance for veterans
‚Ä¢ Family coverage at discounted rates

This offer expires in 7 days. Don't miss out on the protection your family deserves.

Call us at 1-800-VET-INSURANCE to claim your special offer.

Thank you for your service,
The Veteran Valor Team

Veteran Valor Life Insurance
1-800-VET-INSURANCE
veteranvalorlifeinsurance.com`
            }
        };

        function selectTemplate(templateId) {
            selectedTemplate = templateId;
            
            // Remove selected class from all cards
            document.querySelectorAll('.template-card').forEach(card => {
                card.classList.remove('selected');
            });
            
            // Add selected class to clicked card
            event.currentTarget.classList.add('selected');
            
            showStatus(`Selected: ${templateId} template for bulk sending`, 'success');
        }

        function loadLeadsFromSheet() {
            showStatus('Loading leads from Google Sheets...', 'info');
            
            // Simulate loading leads from the spreadsheet
            // In a real implementation, you would use Google Sheets API
            leads = [
                { name: 'Dennis Osborn', email: 'dmosborn1@gmail.com', phone: '+15083301596', region: 'Massachusetts', status: 'pending' },
                { name: 'Steve Newton', email: 'stevenewton528@gmail.com', phone: '+12702221187', region: 'Kentucky', status: 'pending' },
                { name: 'Dana Motris', email: 'paystubdmorris@gmail.com', phone: '+14792061906', region: 'Arkansas', status: 'pending' },
                { name: 'Nathaniel Depo', email: 'johnlittle@gmail.com', phone: '+19096027041', region: 'Oregon', status: 'pending' },
                { name: 'Maurice Ball', email: 'maurice.top.mann@gmail.com', phone: '+17737060930', region: 'Georgia', status: 'pending' },
                { name: 'Theresa Szafran', email: 'tween.szafran@yahoo.com', phone: '+19078912598', region: 'Alaska', status: 'pending' },
                { name: 'Deborah Phillips', email: 'debphillips2013@gmail.com', phone: '+13076808557', region: 'Wyoming', status: 'pending' },
                { name: 'Rod Gomes', email: 'rodgomes41@gmail.com', phone: '+18084452375', region: 'Hawaii', status: 'pending' },
                { name: 'Stan Dickman', email: 'bsfeednseed@gmail.com', phone: '+19125992247', region: 'Georgia', status: 'pending' },
                { name: 'Edward Godino', email: 'godinoed@gmail.com', phone: '15085838123', region: 'Massachusetts', status: 'pending' }
            ];

            emailStats.total = leads.length;
            emailStats.pending = leads.length;
            emailStats.sent = 0;
            emailStats.failed = 0;

            updateStats();
            displayLeads();
            
            showStatus(`Loaded ${leads.length} leads from Google Sheets`, 'success');
        }

        function displayLeads() {
            const tableBody = document.getElementById('leadsTableBody');
            tableBody.innerHTML = '';

            leads.forEach((lead, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${lead.name}</td>
                    <td>${lead.email}</td>
                    <td>${lead.phone}</td>
                    <td>${lead.region}</td>
                    <td><span class="email-status status-${lead.status}">${lead.status}</span></td>
                `;
                tableBody.appendChild(row);
            });

            document.getElementById('leadsTable').style.display = 'block';
        }

        function sendBulkEmails() {
            if (leads.length === 0) {
                showStatus('Please load leads from Google Sheets first!', 'error');
                return;
            }

            if (!selectedTemplate) {
                showStatus('Please select an email template first!', 'error');
                return;
            }

            document.getElementById('loadingDiv').style.display = 'block';
            showStatus('Sending bulk emails...', 'info');

            const template = emailTemplates[selectedTemplate];
            let sentCount = 0;
            let failedCount = 0;

            // Send emails with delay to avoid rate limiting
            leads.forEach((lead, index) => {
                setTimeout(() => {
                    sendEmailToLead(lead, template, index, leads.length);
                }, index * 1000); // 1 second delay between emails
            });
        }

        function sendEmailToLead(lead, template, index, total) {
            const personalizedBody = template.body.replace('{FIRST_NAME}', lead.name.split(' ')[0] || 'Veteran');

            const formData = new FormData();
            formData.append('to', lead.email);
            formData.append('subject', template.subject);
            formData.append('message', personalizedBody);
            formData.append('from', 'Veteran Valor Life Insurance');

            fetch(FORMSPREE_ENDPOINT, {
                method: 'POST',
                body: formData,
                headers: {
                    'Accept': 'application/json'
                }
            })
            .then(response => {
                if (response.ok) {
                    lead.status = 'sent';
                    emailStats.sent++;
                    emailStats.pending--;
                    showStatus(`‚úÖ Email sent to ${lead.email}`, 'success');
                } else {
                    lead.status = 'failed';
                    emailStats.failed++;
                    emailStats.pending--;
                    showStatus(`‚ùå Failed to send to ${lead.email}`, 'error');
                }

                updateStats();
                updateProgress(index + 1, total);
                displayLeads();

                if (index + 1 === total) {
                    document.getElementById('loadingDiv').style.display = 'none';
                    showStatus(`Bulk email complete! Sent: ${emailStats.sent}, Failed: ${emailStats.failed}`, 'success');
                }
            })
            .catch(error => {
                lead.status = 'failed';
                emailStats.failed++;
                emailStats.pending--;
                showStatus(`‚ùå Error sending to ${lead.email}: ${error.message}`, 'error');
                
                updateStats();
                updateProgress(index + 1, total);
                displayLeads();

                if (index + 1 === total) {
                    document.getElementById('loadingDiv').style.display = 'none';
                    showStatus(`Bulk email complete! Sent: ${emailStats.sent}, Failed: ${emailStats.failed}`, 'success');
                }
            });
        }

        function updateProgress(current, total) {
            const percentage = (current / total) * 100;
            document.getElementById('progressFill').style.width = percentage + '%';
        }

        function updateStats() {
            document.getElementById('totalLeads').textContent = emailStats.total;
            document.getElementById('emailsSent').textContent = emailStats.sent;
            document.getElementById('emailsFailed').textContent = emailStats.failed;
            document.getElementById('emailsPending').textContent = emailStats.pending;
        }

        function setupAutoEmails() {
            showStatus('Setting up automatic email sending for new leads...', 'info');
            
            // In a real implementation, this would set up webhooks or polling
            // to monitor the Google Sheets for new leads and automatically send emails
            
            setTimeout(() => {
                showStatus('‚úÖ Automatic email system configured! New leads will receive emails automatically.', 'success');
            }, 2000);
        }

        function openGoogleSheets() {
            window.open(SHEET_URL, '_blank');
        }

        function checkEmailLogs() {
            showStatus('üìã Email logs would be available here in a real implementation', 'info');
        }

        function showStatus(message, type) {
            const statusElement = document.getElementById('statusMessage');
            statusElement.textContent = message;
            statusElement.className = `status status-${type}`;
        }

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            // Auto-select the first template
            const firstTemplate = document.querySelector('.template-card');
            if (firstTemplate) {
                firstTemplate.click();
            }
        });
    </script>
</body>
</html> 