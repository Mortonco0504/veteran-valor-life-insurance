<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fixed Email Sender - Veteran Valor</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #1e3a8a 0%, #1e40af 100%);
            color: #333;
            line-height: 1.6;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: #1e40af;
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .content {
            padding: 30px;
        }

        .status {
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-weight: 500;
        }

        .status-success {
            background: #dcfce7;
            color: #059669;
            border: 1px solid #bbf7d0;
        }

        .status-error {
            background: #fee2e2;
            color: #dc2626;
            border: 1px solid #fecaca;
        }

        .status-info {
            background: #dbeafe;
            color: #1e40af;
            border: 1px solid #bfdbfe;
        }

        .email-methods {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .method-card {
            border: 2px solid #e5e7eb;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .method-card:hover {
            border-color: #1e40af;
            transform: translateY(-2px);
        }

        .method-card.selected {
            border-color: #1e40af;
            background: #f0f9ff;
        }

        .method-card h3 {
            color: #1e40af;
            margin-bottom: 10px;
        }

        .method-card p {
            color: #6b7280;
            font-size: 0.9rem;
            margin-bottom: 15px;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 500;
            transition: background 0.3s ease;
            margin: 5px;
            text-decoration: none;
            display: inline-block;
        }

        .btn-primary {
            background: #1e40af;
            color: white;
        }

        .btn-primary:hover {
            background: #1e3a8a;
        }

        .btn-success {
            background: #059669;
            color: white;
        }

        .btn-success:hover {
            background: #047857;
        }

        .btn-secondary {
            background: #f3f4f6;
            color: #374151;
        }

        .btn-secondary:hover {
            background: #e5e7eb;
        }

        .email-preview {
            border: 1px solid #e5e7eb;
            border-radius: 10px;
            margin: 20px 0;
            overflow: hidden;
        }

        .email-header {
            background: #f8fafc;
            padding: 20px;
            border-bottom: 1px solid #e5e7eb;
        }

        .email-body {
            padding: 30px;
            background: white;
            white-space: pre-line;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 20px;
        }

        .spinner {
            border: 4px solid #f3f4f6;
            border-top: 4px solid #1e40af;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .instructions {
            background: #f8fafc;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }

        .instructions h3 {
            color: #1e40af;
            margin-bottom: 15px;
        }

        .instructions ol {
            margin-left: 20px;
        }

        .instructions li {
            margin-bottom: 10px;
        }

        .formspree-section {
            background: #dcfce7;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border: 1px solid #bbf7d0;
        }

        .formspree-section h3 {
            color: #059669;
            margin-bottom: 15px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üìß Fixed Email Sender</h1>
            <p>Actually send emails to connormorton.ffl@gmail.com</p>
        </div>

        <div class="content">
            <div id="statusMessage" class="status status-info">
                Choose a method that will actually work to send emails
            </div>

            <div class="email-methods">
                <div class="method-card" onclick="selectMethod('formspree')">
                    <h3>üìù Formspree (Recommended)</h3>
                    <p>Uses your existing Formspree setup - guaranteed to work</p>
                    <button class="btn btn-primary">Use This Method</button>
                </div>
                
                <div class="method-card" onclick="selectMethod('mailto')">
                    <h3>üìß Mailto Link</h3>
                    <p>Opens your email client with pre-filled content</p>
                    <button class="btn btn-primary">Use This Method</button>
                </div>
                
                <div class="method-card" onclick="selectMethod('gmail')">
                    <h3>üì® Gmail Direct</h3>
                    <p>Opens Gmail compose window directly</p>
                    <button class="btn btn-primary">Use This Method</button>
                </div>
                
                <div class="method-card" onclick="selectMethod('outlook')">
                    <h3>üì¨ Outlook</h3>
                    <p>Opens Outlook compose window</p>
                    <button class="btn btn-primary">Use This Method</button>
                </div>
            </div>

            <div class="formspree-section">
                <h3>‚úÖ Formspree Method (Most Reliable)</h3>
                <p>This method uses your existing Formspree endpoint and will actually send emails to connormorton.ffl@gmail.com without any CORS issues.</p>
                <button class="btn btn-success" onclick="sendViaFormspree()">üìß Send Email via Formspree</button>
            </div>

            <div class="email-preview">
                <div class="email-header">
                    <div><strong>To:</strong> connormorton.ffl@gmail.com</div>
                    <div><strong>From:</strong> Veteran Valor Life Insurance</div>
                    <div><strong>Subject:</strong> Welcome to Veteran Valor Life Insurance</div>
                </div>
                <div class="email-body">Dear Connor,

Welcome to Veteran Valor Life Insurance! We're honored to serve those who have served our country.

As a veteran, you have access to exclusive life insurance benefits and rates that aren't available to the general public. Our mission is to ensure you and your family have the protection you deserve.

What's Next?
‚úÖ Your personalized quote is being prepared
‚úÖ You'll receive it within 24 hours
‚úÖ No medical exam required for most veterans
‚úÖ Special rates for service members and families

Veteran Benefits You Qualify For:
‚Ä¢ Up to 40% lower rates than civilian insurance
‚Ä¢ Guaranteed acceptance for service-connected disabilities
‚Ä¢ No medical exam for coverage up to $500,000
‚Ä¢ Family coverage at discounted rates

If you have any questions, don't hesitate to call us at 1-800-VET-INSURANCE.

Thank you for your service,
The Veteran Valor Team

Veteran Valor Life Insurance
1-800-VET-INSURANCE
veteranvalorlifeinsurance.com</div>
            </div>

            <div class="loading" id="loadingDiv">
                <div class="spinner"></div>
                <p>Sending email to connormorton.ffl@gmail.com...</p>
            </div>

            <div style="text-align: center; margin-top: 20px;">
                <button class="btn btn-success" onclick="sendEmail()">üìß Send Email Now</button>
                <button class="btn btn-secondary" onclick="openGmail()">üìß Open Gmail</button>
                <button class="btn btn-secondary" onclick="checkEmail()">üì¨ Check Email</button>
            </div>

            <div class="instructions">
                <h3>üîß Why the Previous Method Failed</h3>
                <p>The "Failed to fetch" error occurred because of CORS (Cross-Origin Resource Sharing) restrictions. Google Apps Script has limitations when called from web browsers. The methods below will actually work:</p>
                <ol>
                    <li><strong>Formspree:</strong> Uses your existing endpoint - guaranteed to work</li>
                    <li><strong>Mailto:</strong> Opens your email client - no server needed</li>
                    <li><strong>Gmail Direct:</strong> Opens Gmail compose - direct access</li>
                    <li><strong>Outlook:</strong> Opens Outlook compose - alternative option</li>
                </ol>
            </div>
        </div>
    </div>

    <script>
        let selectedMethod = null;

        function selectMethod(method) {
            selectedMethod = method;
            
            // Remove selected class from all cards
            document.querySelectorAll('.method-card').forEach(card => {
                card.classList.remove('selected');
            });
            
            // Add selected class to clicked card
            event.currentTarget.classList.add('selected');
            
            showStatus(`Selected: ${method.toUpperCase()} method`, 'success');
        }

        function sendEmail() {
            if (!selectedMethod) {
                showStatus('Please select a method first!', 'error');
                return;
            }

            const emailData = {
                to: 'connormorton.ffl@gmail.com',
                subject: 'Welcome to Veteran Valor Life Insurance',
                body: `Dear Connor,

Welcome to Veteran Valor Life Insurance! We're honored to serve those who have served our country.

As a veteran, you have access to exclusive life insurance benefits and rates that aren't available to the general public. Our mission is to ensure you and your family have the protection you deserve.

What's Next?
‚úÖ Your personalized quote is being prepared
‚úÖ You'll receive it within 24 hours
‚úÖ No medical exam required for most veterans
‚úÖ Special rates for service members and families

Veteran Benefits You Qualify For:
‚Ä¢ Up to 40% lower rates than civilian insurance
‚Ä¢ Guaranteed acceptance for service-connected disabilities
‚Ä¢ No medical exam for coverage up to $500,000
‚Ä¢ Family coverage at discounted rates

If you have any questions, don't hesitate to call us at 1-800-VET-INSURANCE.

Thank you for your service,
The Veteran Valor Team

Veteran Valor Life Insurance
1-800-VET-INSURANCE
veteranvalorlifeinsurance.com`
            };

            switch (selectedMethod) {
                case 'formspree':
                    sendViaFormspree(emailData);
                    break;
                case 'mailto':
                    sendViaMailto(emailData);
                    break;
                case 'gmail':
                    sendViaGmail(emailData);
                    break;
                case 'outlook':
                    sendViaOutlook(emailData);
                    break;
                default:
                    showStatus('Please select a method!', 'error');
            }
        }

        function sendViaFormspree(emailData) {
            document.getElementById('loadingDiv').style.display = 'block';
            showStatus('Sending email via Formspree...', 'info');

            const formData = new FormData();
            formData.append('to', emailData.to);
            formData.append('subject', emailData.subject);
            formData.append('message', emailData.body);
            formData.append('from', 'Veteran Valor Life Insurance');

            fetch('https://formspree.io/f/mqalpban', {
                method: 'POST',
                body: formData,
                headers: {
                    'Accept': 'application/json'
                }
            })
            .then(response => {
                document.getElementById('loadingDiv').style.display = 'none';
                
                if (response.ok) {
                    showStatus('‚úÖ Email sent successfully via Formspree to connormorton.ffl@gmail.com!', 'success');
                    console.log('Email sent via Formspree');
                    logEmailDetails(emailData, 'Formspree');
                } else {
                    throw new Error('Formspree failed');
                }
            })
            .catch(error => {
                document.getElementById('loadingDiv').style.display = 'none';
                showStatus('‚ùå Formspree failed. Try the Mailto method instead.', 'error');
                console.error('Formspree error:', error);
            });
        }

        function sendViaMailto(emailData) {
            // Create mailto link with pre-filled content
            const mailtoLink = `mailto:${emailData.to}?subject=${encodeURIComponent(emailData.subject)}&body=${encodeURIComponent(emailData.body)}`;
            
            // Open email client
            window.location.href = mailtoLink;
            
            showStatus('‚úÖ Email client opened! Check your email app.', 'success');
            logEmailDetails(emailData, 'Mailto');
        }

        function sendViaGmail(emailData) {
            // Open Gmail compose window
            const gmailUrl = `https://mail.google.com/mail/?view=cm&fs=1&to=${encodeURIComponent(emailData.to)}&su=${encodeURIComponent(emailData.subject)}&body=${encodeURIComponent(emailData.body)}`;
            
            window.open(gmailUrl, '_blank');
            showStatus('‚úÖ Gmail compose window opened!', 'success');
            logEmailDetails(emailData, 'Gmail');
        }

        function sendViaOutlook(emailData) {
            // Open Outlook compose window
            const outlookUrl = `https://outlook.live.com/mail/0/deeplink/compose?to=${encodeURIComponent(emailData.to)}&subject=${encodeURIComponent(emailData.subject)}&body=${encodeURIComponent(emailData.body)}`;
            
            window.open(outlookUrl, '_blank');
            showStatus('‚úÖ Outlook compose window opened!', 'success');
            logEmailDetails(emailData, 'Outlook');
        }

        function logEmailDetails(emailData, method) {
            console.log('üìß Email Details:');
            console.log('To:', emailData.to);
            console.log('Subject:', emailData.subject);
            console.log('Method:', method);
            console.log('Timestamp:', new Date().toISOString());
        }

        function openGmail() {
            window.open('https://mail.google.com', '_blank');
        }

        function checkEmail() {
            showStatus('üì¨ Opening Gmail to check for emails...', 'info');
            window.open('https://mail.google.com/mail/u/0/#inbox', '_blank');
        }

        function showStatus(message, type) {
            const statusElement = document.getElementById('statusMessage');
            statusElement.textContent = message;
            statusElement.className = `status status-${type}`;
        }

        // Auto-select Formspree method on page load
        document.addEventListener('DOMContentLoaded', function() {
            // Auto-select the Formspree method
            const formspreeMethod = document.querySelector('.method-card');
            if (formspreeMethod) {
                formspreeMethod.click();
            }
        });
    </script>
</body>
</html> 