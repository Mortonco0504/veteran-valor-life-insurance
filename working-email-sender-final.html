<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Working Email Sender - Veteran Valor</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #1e3a8a 0%, #1e40af 100%);
            color: #333;
            line-height: 1.6;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: #1e40af;
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .content {
            padding: 30px;
        }

        .status {
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-weight: 500;
        }

        .status-success {
            background: #dcfce7;
            color: #059669;
            border: 1px solid #bbf7d0;
        }

        .status-error {
            background: #fee2e2;
            color: #dc2626;
            border: 1px solid #fecaca;
        }

        .status-info {
            background: #dbeafe;
            color: #1e40af;
            border: 1px solid #bfdbfe;
        }

        .email-templates {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .template-card {
            border: 2px solid #e5e7eb;
            border-radius: 10px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .template-card:hover {
            border-color: #1e40af;
            transform: translateY(-2px);
        }

        .template-card.selected {
            border-color: #1e40af;
            background: #f0f9ff;
        }

        .template-card h3 {
            color: #1e40af;
            margin-bottom: 10px;
        }

        .template-card p {
            color: #6b7280;
            font-size: 0.9rem;
            margin-bottom: 15px;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 500;
            transition: background 0.3s ease;
            margin: 5px;
        }

        .btn-primary {
            background: #1e40af;
            color: white;
        }

        .btn-primary:hover {
            background: #1e3a8a;
        }

        .btn-success {
            background: #059669;
            color: white;
        }

        .btn-success:hover {
            background: #047857;
        }

        .btn-secondary {
            background: #f3f4f6;
            color: #374151;
        }

        .btn-secondary:hover {
            background: #e5e7eb;
        }

        .email-preview {
            border: 1px solid #e5e7eb;
            border-radius: 10px;
            margin: 20px 0;
            overflow: hidden;
        }

        .email-header {
            background: #f8fafc;
            padding: 20px;
            border-bottom: 1px solid #e5e7eb;
        }

        .email-body {
            padding: 30px;
            background: white;
            white-space: pre-line;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 20px;
        }

        .spinner {
            border: 4px solid #f3f4f6;
            border-top: 4px solid #1e40af;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .script-info {
            background: #f8fafc;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }

        .script-info h3 {
            color: #1e40af;
            margin-bottom: 15px;
        }

        .script-url {
            background: #1f2937;
            color: #f9fafb;
            padding: 10px;
            border-radius: 6px;
            font-family: monospace;
            font-size: 0.8rem;
            word-break: break-all;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üìß Working Email Sender</h1>
            <p>Send real emails to connormorton.ffl@gmail.com</p>
        </div>

        <div class="content">
            <div id="statusMessage" class="status status-success">
                ‚úÖ Your Google Apps Script is working! Ready to send emails.
            </div>

            <div class="script-info">
                <h3>üîß Connected Script</h3>
                <p>Your Google Apps Script is properly configured and ready to send emails:</p>
                <div class="script-url">https://script.google.com/macros/s/AKfycbyEMWa2yazqaUQWrKEloiUR5pctN-KIq_yvaI-jlxcqbrOpPLX4A1Ls_IY-YMq1ln6fRQ/exec</div>
                <p>Status: ‚úÖ Active and Ready</p>
            </div>

            <div class="email-templates">
                <div class="template-card" onclick="selectTemplate('welcome')">
                    <h3>üéØ Welcome Email</h3>
                    <p>Initial welcome message for new leads</p>
                    <button class="btn btn-primary">Select Template</button>
                </div>
                
                <div class="template-card" onclick="selectTemplate('quote')">
                    <h3>üìã Quote Ready</h3>
                    <p>Personalized quote delivery email</p>
                    <button class="btn btn-primary">Select Template</button>
                </div>
                
                <div class="template-card" onclick="selectTemplate('education')">
                    <h3>üìö Educational</h3>
                    <p>Veteran life insurance education content</p>
                    <button class="btn btn-primary">Select Template</button>
                </div>
                
                <div class="template-card" onclick="selectTemplate('offer')">
                    <h3>üéÅ Special Offer</h3>
                    <p>Limited-time veteran discount offer</p>
                    <button class="btn btn-primary">Select Template</button>
                </div>
            </div>

            <div class="email-preview">
                <div class="email-header">
                    <div><strong>To:</strong> connormorton.ffl@gmail.com</div>
                    <div><strong>From:</strong> Veteran Valor Life Insurance</div>
                    <div><strong>Subject:</strong> <span id="previewSubject">Welcome to Veteran Valor Life Insurance</span></div>
                </div>
                <div class="email-body" id="previewBody">Dear Connor,

Welcome to Veteran Valor Life Insurance! We're honored to serve those who have served our country.

As a veteran, you have access to exclusive life insurance benefits and rates that aren't available to the general public. Our mission is to ensure you and your family have the protection you deserve.

What's Next?
‚úÖ Your personalized quote is being prepared
‚úÖ You'll receive it within 24 hours
‚úÖ No medical exam required for most veterans
‚úÖ Special rates for service members and families

Veteran Benefits You Qualify For:
‚Ä¢ Up to 40% lower rates than civilian insurance
‚Ä¢ Guaranteed acceptance for service-connected disabilities
‚Ä¢ No medical exam for coverage up to $500,000
‚Ä¢ Family coverage at discounted rates

If you have any questions, don't hesitate to call us at 1-800-VET-INSURANCE.

Thank you for your service,
The Veteran Valor Team

Veteran Valor Life Insurance
1-800-VET-INSURANCE
veteranvalorlifeinsurance.com</div>
            </div>

            <div class="loading" id="loadingDiv">
                <div class="spinner"></div>
                <p>Sending email to connormorton.ffl@gmail.com...</p>
            </div>

            <div style="text-align: center; margin-top: 20px;">
                <button class="btn btn-success" onclick="sendEmail()">üìß Send Email Now</button>
                <button class="btn btn-secondary" onclick="openGmail()">üìß Open Gmail</button>
                <button class="btn btn-secondary" onclick="checkEmail()">üì¨ Check Email</button>
            </div>
        </div>
    </div>

    <script>
        // Your working Google Apps Script URL
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbyEMWa2yazqaUQWrKEloiUR5pctN-KIq_yvaI-jlxcqbrOpPLX4A1Ls_IY-YMq1ln6fRQ/exec';
        
        let selectedTemplate = 'welcome';

        // Email templates
        const emailTemplates = {
            'welcome': {
                subject: 'Welcome to Veteran Valor Life Insurance',
                body: `Dear Connor,

Welcome to Veteran Valor Life Insurance! We're honored to serve those who have served our country.

As a veteran, you have access to exclusive life insurance benefits and rates that aren't available to the general public. Our mission is to ensure you and your family have the protection you deserve.

What's Next?
‚úÖ Your personalized quote is being prepared
‚úÖ You'll receive it within 24 hours
‚úÖ No medical exam required for most veterans
‚úÖ Special rates for service members and families

Veteran Benefits You Qualify For:
‚Ä¢ Up to 40% lower rates than civilian insurance
‚Ä¢ Guaranteed acceptance for service-connected disabilities
‚Ä¢ No medical exam for coverage up to $500,000
‚Ä¢ Family coverage at discounted rates

If you have any questions, don't hesitate to call us at 1-800-VET-INSURANCE.

Thank you for your service,
The Veteran Valor Team

Veteran Valor Life Insurance
1-800-VET-INSURANCE
veteranvalorlifeinsurance.com`
            },
            'quote': {
                subject: 'Your Free Life Insurance Quote is Ready',
                body: `Dear Connor,

Great news! Your personalized life insurance quote is ready. Based on your veteran status and preferences, here's what we found for you:

Your Recommended Coverage:
‚Ä¢ Coverage Amount: $500,000
‚Ä¢ Monthly Premium: $45
‚Ä¢ Policy Type: Term Life
‚Ä¢ Veteran Discount: 25%

This quote includes your exclusive veteran benefits and is valid for 30 days.

Ready to get started? Call us at 1-800-VET-INSURANCE to speak with a veteran specialist.

Best regards,
The Veteran Valor Team

Veteran Valor Life Insurance
1-800-VET-INSURANCE
veteranvalorlifeinsurance.com`
            },
            'education': {
                subject: 'Veteran Life Insurance: 5 Things You Need to Know',
                body: `Dear Connor,

As a veteran, you have unique life insurance options that most people don't know about. Here are the 5 most important things you need to know:

1. VA Life Insurance vs. Private Insurance
While VA life insurance is available, private insurance often offers better rates and more flexibility. Many veterans can save 20-40% with private coverage.

2. No Medical Exam Options
Veterans with service-connected disabilities can often get guaranteed acceptance life insurance with no medical exam required.

3. Family Coverage Benefits
Your veteran status can qualify your entire family for discounted rates, including spouses and children.

4. Portability After Service
Private life insurance stays with you after leaving the military, unlike some military-specific coverage.

5. Tax Benefits
Life insurance death benefits are typically tax-free, providing maximum protection for your family.

Ready to learn more? Call us at 1-800-VET-INSURANCE.

Thank you for your service,
The Veteran Valor Team

Veteran Valor Life Insurance
1-800-VET-INSURANCE
veteranvalorlifeinsurance.com`
            },
            'offer': {
                subject: 'Special Veteran Life Insurance Offer - 25% Off',
                body: `Dear Connor,

We have a special offer just for veterans like you!

üéÅ SPECIAL VETERAN OFFER:
‚Ä¢ 25% off your first year premium
‚Ä¢ No medical exam required
‚Ä¢ Guaranteed acceptance for veterans
‚Ä¢ Family coverage at discounted rates

This offer expires in 7 days. Don't miss out on the protection your family deserves.

Call us at 1-800-VET-INSURANCE to claim your special offer.

Thank you for your service,
The Veteran Valor Team

Veteran Valor Life Insurance
1-800-VET-INSURANCE
veteranvalorlifeinsurance.com`
            }
        };

        function selectTemplate(templateId) {
            selectedTemplate = templateId;
            
            // Remove selected class from all cards
            document.querySelectorAll('.template-card').forEach(card => {
                card.classList.remove('selected');
            });
            
            // Add selected class to clicked card
            event.currentTarget.classList.add('selected');
            
            // Update preview
            const template = emailTemplates[templateId];
            if (template) {
                document.getElementById('previewSubject').textContent = template.subject;
                document.getElementById('previewBody').textContent = template.body;
            }
            
            showStatus(`Selected: ${templateId} template`, 'success');
        }

        function sendEmail() {
            const template = emailTemplates[selectedTemplate];
            if (!template) {
                showStatus('Please select a template first!', 'error');
                return;
            }

            document.getElementById('loadingDiv').style.display = 'block';
            showStatus('Sending email via Google Apps Script...', 'info');

            const emailData = {
                to: 'connormorton.ffl@gmail.com',
                subject: template.subject,
                body: template.body
            };

            // Send email using your Google Apps Script
            fetch(SCRIPT_URL, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(emailData)
            })
            .then(response => response.json())
            .then(data => {
                document.getElementById('loadingDiv').style.display = 'none';
                
                if (data.success) {
                    showStatus('‚úÖ Email sent successfully to connormorton.ffl@gmail.com!', 'success');
                    console.log('Email sent successfully:', data.message);
                    
                    // Log email details
                    logEmailDetails(emailData);
                } else {
                    throw new Error(data.message);
                }
            })
            .catch(error => {
                document.getElementById('loadingDiv').style.display = 'none';
                showStatus('‚ùå Failed to send email: ' + error.message, 'error');
                console.error('Email send error:', error);
            });
        }

        function logEmailDetails(emailData) {
            console.log('üìß Email Details:');
            console.log('To:', emailData.to);
            console.log('Subject:', emailData.subject);
            console.log('Template:', selectedTemplate);
            console.log('Script URL:', SCRIPT_URL);
            console.log('Timestamp:', new Date().toISOString());
        }

        function openGmail() {
            window.open('https://mail.google.com', '_blank');
        }

        function checkEmail() {
            showStatus('üì¨ Opening Gmail to check for the email...', 'info');
            window.open('https://mail.google.com/mail/u/0/#inbox', '_blank');
        }

        function showStatus(message, type) {
            const statusElement = document.getElementById('statusMessage');
            statusElement.textContent = message;
            statusElement.className = `status status-${type}`;
        }

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            // Auto-select the first template
            const firstTemplate = document.querySelector('.template-card');
            if (firstTemplate) {
                firstTemplate.click();
            }
        });
    </script>
</body>
</html> 